from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.common.exceptions import NoSuchElementException
import time

# Inicia el navegador Chrome
print("🟢 Iniciando prueba de login con Selenium...")
driver = webdriver.Chrome()

try:
    # Abrir la URL del sistema
    print("🌐 Abriendo página de login...")
    driver.get("http://172.16.5.4/sgd/login.do")
    time.sleep(2)  # Esperar que cargue la página

    # Completar los campos del formulario de login
    print("✏️ Ingresando usuario y contraseña...")
    driver.find_element(By.ID, "coUsuario").send_keys("admin")
    driver.find_element(By.ID, "dePass").send_keys("1234")

    # Hacer clic en el botón de ingreso
    print("➡️ Haciendo clic en el botón de login...")
    driver.find_element(By.XPATH, "//button[@type='submit']").click()
    time.sleep(3)  # Esperar a que cargue la siguiente página

    # Verificar si el login fue exitoso
    print("🔍 Verificando si el login fue exitoso...")
    try:
        driver.find_element(By.XPATH, "//*[contains(text(), 'Bienvenido')]")
        print("✅ Login exitoso.")
    except NoSuchElementException:
        print("❌ Login fallido. Texto de bienvenida no encontrado.")

    # Tomar captura de pantalla
    print("📸 Guardando captura como 'resultado_login.png'...")
    driver.save_screenshot("resultado_login.png")

except Exception as e:
    print("❌ Error durante la ejecución:")
    print(e)

finally:
    print("🚪 Cerrando navegador...")
    driver.quit()
